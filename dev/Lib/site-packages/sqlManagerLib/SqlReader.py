import pyodbc 
class sqlManager:
    def __init__(self,server,database,username,password):
        self.cnxn = pyodbc.connect('DRIVER={ODBC Driver 17 for SQL Server};SERVER='+server+';DATABASE='+database+';ENCRYPT=no;UID='+username+';PWD='+ password+";Trust Server Certificate=yes")
        self.cursor=self.cnxn.cursor()

    def Get5Orders(self, order="desc"):
        data=self.cursor.execute("select * from dbo.orders ORDER BY "+).fetchmany(5)
        print(data)
        return data

    def insertOffice(self,myDict:dict):
        placeholders = ', '.join(['%s'] * len(myDict))
        columns = ', '.join(myDict.keys())
        sql = "INSERT INTO dbo.offices ( %s ) VALUES ( %s )" % (columns, placeholders)
        print(sql)
        self.cursor.execute(sql)
        self.commit()

    def commit(self):
        self.cnxn.commit()
